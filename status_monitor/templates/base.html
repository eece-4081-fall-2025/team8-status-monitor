{% load static %}
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="csrf-token" content="{{ csrf_token }}">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>{% block title %}Status Monitor{% endblock %}</title>
        <link rel="stylesheet" href="{% static 'css/main.css' %}">
    </head>
    <body>
        <header class="header">
            <h1>Status Monitor</h1>
            <nav class="navbar">
                <a href="{% url 'status_page' %}">Status</a>
                <a href="{% url 'maintenance_page' %}">Maintenance</a>
                <a href="{% url 'incidents_page' %}">Incident Report</a>
                <a href="{% url 'logout' %}">Logout</a>
            </nav>
        </header>

        <main class="content-container">
            {% block content %}
            {% endblock %}
        </main>

        <script>
            (function () {
                try {
                    const tz = Intl.DateTimeFormat().resolvedOptions().timeZone;

                    if (!sessionStorage.getItem('tz_set')) {
                        fetch("/set_timezone/", {
                            method: "POST",
                            headers: {
                                "Content-Type": "application/x-www-form-urlencoded",
                                "X-CSRFToken": document.querySelector('meta[name="csrf-token"]').content
                            },
                            body: new URLSearchParams({ timezone: tz })
                        })
                        .then(() => {
                            sessionStorage.setItem('tz_set', '1');
                            location.reload();
                        })
                        .catch(() => {});
                    }
                } catch (e) {}
            })();
        </script>

    </body>
</html>

